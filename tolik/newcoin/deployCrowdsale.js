var fs = require('fs');
var erisC = require('eris-contracts');

var erisdbURL = "http://localhost:1337/rpc";

var idisAbi = JSON.parse(fs.readFileSync("../crowdsale/abi/Crowdsale.abi", 'utf8'));

var accountData = require('./accounts.json');

var contractsManager = erisC.newContractManagerDev(erisdbURL, accountData.simplechain_full_000);

var compiled = "60606040526000600960006101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055506000600960016101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055506040516114a43803806114a4833981016040528080519060200190919080519060200190919080519060200190919080519060200190919080518201919060200150505b33600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555084600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c0100000000000000000000000090810204021790555083600260005081905550603c8302420160046000508190555081600560006101000a81548160ff02191690837f010000000000000000000000000000000000000000000000000000000000000090810204021790555061019d816101b2565b505b50505050506111198061038b6000396000f35b600060006000600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141580156102645750600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614155b156102725760009250610384565b600091505b835182101561037c578382815181101561000257906020019060200201519050600660005080548060010182818154818355818115116102e9578183600052602060002091820191016102e891906102ca565b808211156102e457600081815060009055506001016102ca565b5090565b5b5050509190906000526020600020900160005b83909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff02191690836c01000000000000000000000000908102040217905550506000600860005060008373ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600050819055508180600101925050610277565b819250610384565b505091905056606060405236156100cc576000357c01000000000000000000000000000000000000000000000000000000009004806301cb3b20146100d157806302d05d3f146100fb57806329dcb0cf1461013957806338af3eed146101615780633962f82d1461019f5780637a2d5add146101c75780637a3a0e84146101fa5780637b3e5e7b146102225780638f4ffcb11461024a578063a0e2e5f6146102d6578063c5064cb014610307578063e4e0ef3514610331578063f7888aec14610378578063fd6b7ef8146103b2576100cc565b610002565b34610002576100e360048050506103dc565b60405180821515815260200191505060405180910390f35b346100025761010d6004805050610539565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b346100025761014b600480505061055f565b6040518082815260200191505060405180910390f35b34610002576101736004805050610568565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34610002576101b1600480505061058e565b6040518082815260200191505060405180910390f35b34610002576101e260048080359060200190919050506105a3565b60405180821515815260200191505060405180910390f35b346100025761020c600480505061066e565b6040518082815260200191505060405180910390f35b34610002576102346004805050610677565b6040518082815260200191505060405180910390f35b34610002576102be6004808035906020019091908035906020019091908035906020019091908035906020019082018035906020019191908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050909091905050610680565b60405180821515815260200191505060405180910390f35b34610002576102f16004808035906020019091905050610976565b6040518082815260200191505060405180910390f35b34610002576103196004805050610991565b60405180821515815260200191505060405180910390f35b346100025761034c60048080359060200190919050506109a4565b604051808273ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b346100025761039c60048080359060200190919080359060200190919050506109e6565b6040518082815260200191505060405180910390f35b34610002576103c46004805050610a11565b60405180821515815260200191505060405180910390f35b6000600460005054421015806103fe5750600560009054906101000a900460ff165b1561051f576002600050546003600050541015156104d1576001600960006101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055507fec3f991caf7857d61663fd1bba1739e04abd4781238508cde554bb849d790c85600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600360005054604051808373ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a15b6004600050544210151561051e576001600960016101000a81548160ff02191690837f01000000000000000000000000000000000000000000000000000000000000009081020402179055505b5b600960019054906101000a900460ff169050610536565b90565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60046000505481565b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600060066000508054905090506105a0565b90565b60006000600960019054906101000a900460ff16156105c55760009150610668565b600090505b60066000508054905081101561065f57600660005081815481101561000257906000526020600020900160005b9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1614156106525760019150610668565b80806001019150506105ca565b60009150610668565b50919050565b60026000505481565b60036000505481565b6000600061068d846105a3565b151561069c576000915061096d565b3090508373ffffffffffffffffffffffffffffffffffffffff166323b872dd878388600060405160200152604051847c0100000000000000000000000000000000000000000000000000000000028152600401808473ffffffffffffffffffffffffffffffffffffffff1681526020018373ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019350505050602060405180830381600087803b156100025760325a03f1156100025750505060405180519060200150151561076c576000915061096d565b6000600760005060008873ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060005060008673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000505414156108315784600760005060008873ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060005060008673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060005081905550610898565b84600760005060008873ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060005060008673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828282505401925050819055505b84600860005060008673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828282505401925050819055508460036000828282505401925050819055507f1fe43a085f5507370c77d08b78179e99076ad281426b5189351310be1b72625c8685876001604051808573ffffffffffffffffffffffffffffffffffffffff1681526020018473ffffffffffffffffffffffffffffffffffffffff168152602001838152602001821515815260200194505050505060405180910390a16001915061096d565b50949350505050565b60086000506020528060005260406000206000915090505481565b600560009054906101000a900460ff1681565b600660005081815481101561000257906000526020600020900160005b9150909054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6007600050602052816000526040600020600050602052806000526040600020600091509150505481565b60006000600060006000610a236103dc565b1515610a325760009450611112565b600960009054906101000a900460ff161515610da0576000935083505b600660005080549050841015610d9757600660005084815481101561000257906000526020600020900160005b9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1692508250600073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1614158015610b3657506000600760005060003373ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060005060008573ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000505414155b15610d8a57600760005060003373ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060005060008473ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060005054915081506000600760005060003373ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060005060008573ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600050819055506000821115610d89578273ffffffffffffffffffffffffffffffffffffffff1663a9059cbb3384600060405160200152604051837c0100000000000000000000000000000000000000000000000000000000028152600401808373ffffffffffffffffffffffffffffffffffffffff16815260200182815260200192505050602060405180830381600087803b156100025760325a03f115610002575050506040518051906020015015610d29577f1fe43a085f5507370c77d08b78179e99076ad281426b5189351310be1b72625c3384846000604051808573ffffffffffffffffffffffffffffffffffffffff1681526020018473ffffffffffffffffffffffffffffffffffffffff168152602001838152602001821515815260200194505050505060405180910390a1610d88565b81600760005060003373ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060005060008573ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600050819055505b5b5b8380600101945050610a4f565b60019450611112565b600960009054906101000a900460ff168015610e0957503373ffffffffffffffffffffffffffffffffffffffff16600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16145b1561110957600190506000935083505b60066000508054905084101561110057600073ffffffffffffffffffffffffffffffffffffffff16600660005085815481101561000257906000526020600020900160005b9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415156110f357600660005084815481101561000257906000526020600020900160005b9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1692508250600860005060008473ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060005054915081508273ffffffffffffffffffffffffffffffffffffffff1663a9059cbb600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1684600060405160200152604051837c0100000000000000000000000000000000000000000000000000000000028152600401808373ffffffffffffffffffffffffffffffffffffffff16815260200182815260200192505050602060405180830381600087803b156100025760325a03f1156100025750505060405180519060200150156110ed577f1fe43a085f5507370c77d08b78179e99076ad281426b5189351310be1b72625c600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600660005086815481101561000257906000526020600020900160005b9054906101000a900473ffffffffffffffffffffffffffffffffffffffff166003600050546000604051808573ffffffffffffffffffffffffffffffffffffffff1681526020018473ffffffffffffffffffffffffffffffffffffffff168152602001838152602001821515815260200194505050505060405180910390a1600860005060008473ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600050600090556110f2565b610002565b5b8380600101945050610e19565b60019450611112565b60009450611112565b505050509056";

var myNewContract;

var coins = new Array("1362F2BD1FDF54543E82807673CF285B84BE0C55","02C58F28348774E53ACC58015C900068B9D0AFB8");

contractsManager.newContractFactory(idisAbi).new(
    "2D399D48D853F2B5D9AE34D0CC3DDF53C707CB8B",
    1000,
    10,
    true,
    coins,
    {data: compiled}, 
	function(error, contract){
    if (error) {
        // Something.
        console.log(error);
        throw error;
    }
    myNewContract = contract;
    console.log(myNewContract);
});
